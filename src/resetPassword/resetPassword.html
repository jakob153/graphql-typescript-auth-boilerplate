<!DOCTYPE html>
<html lang="en">
  <head>
    <title>My page</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="minimum-scale=1, initial-scale=1, width=device-width"
    />
    <script
      src="https://unpkg.com/react@latest/umd/react.development.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/react-dom@latest/umd/react-dom.development.js"></script>
    <script
      src="https://unpkg.com/@material-ui/core@latest/umd/material-ui.development.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/babel-standalone@latest/babel.min.js"
      crossorigin="anonymous"
    ></script>
    <!-- Fonts to support Material Design -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
    />
    <!-- Icons to support Material Design -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
  </head>

  <body>
    <div id="root"></div>
    <script type="text/babel">
      const {
        colors,
        CssBaseline,
        ThemeProvider,
        Typography,
        Container,
        makeStyles,
        createMuiTheme,
        Box,
        Link,
        TextField,
        Button,
      } = MaterialUI;

      // Create a theme instance.
      const theme = createMuiTheme({
        palette: {
          type: 'dark',
          primary: colors.blue,
          secondary: colors.blue,
        },
      });

      const useStyles = makeStyles((theme) => ({
        marginBottom4: {
          marginBottom: theme.spacing(4),
        },
      }));

      function Form() {
        const [password, setPassword] = React.useState('');
        const [password2, setPassword2] = React.useState('');
        const classes = useStyles();

        const handlePasswordChange = (event) => {
          setPassword(event.target.value);
        };

        const handlePasswordChange2 = (event) => {
          setPassword2(event.target.value);
        };

        const handleSubmit = async (event) => {
          event.preventDefault();
          try {
            const response = await fetch(window.location.pathname, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ newPassword: password }),
            });
            const data = await response.json();

            window.location.replace(`${data.REACT_APP}?success=true`);
          } catch (error) {
            console.error(error);
          }
        };

        return (
          <React.Fragment>
            <form onSubmit={handleSubmit}>
              <TextField
                className={classes.marginBottom4}
                onChange={handlePasswordChange}
                name="password"
                type="password"
                label="New Password"
                value={password}
                variant="outlined"
                fullWidth
              />
              <TextField
                className={classes.marginBottom4}
                onChange={handlePasswordChange2}
                name="password2"
                type="password"
                label="Confirm New Password"
                value={password2}
                variant="outlined"
                fullWidth
              />
              <Button
                className={classes.marginBottom4}
                type="submit"
                disabled={!password || !(password === password2)}
                variant="contained"
                fullWidth
              >
                Reset Password
              </Button>
            </form>
          </React.Fragment>
        );
      }

      function Copyright() {
        return (
          <Typography variant="body2" color="textSecondary" align="center">
            {'Copyright Â© '}
            <Link color="inherit" href="https://material-ui.com/">
              Your Website
            </Link>{' '}
            {new Date().getFullYear()}
            {'.'}
          </Typography>
        );
      }

      function App() {
        const classes = useStyles();

        return (
          <Container maxWidth="xs">
            <div style={{ marginTop: 24 }}>
              <Typography
                className={classes.marginBottom4}
                variant="h4"
                component="h1"
                gutterBottom
              >
                Reset Password
              </Typography>
              <Form />
              <Copyright />
            </div>
          </Container>
        );
      }

      ReactDOM.render(
        <ThemeProvider theme={theme}>
          <CssBaseline />
          <App />
        </ThemeProvider>,
        document.querySelector('#root')
      );
    </script>
  </body>
</html>
